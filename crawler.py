from random import choice
from colorama import Fore
from json import loads
import requests

# Disable SSL warning
from requests.packages.urllib3.exceptions import InsecureRequestWarning
requests.packages.urllib3.disable_warnings(InsecureRequestWarning)

w = Fore.WHITE
c = Fore.CYAN
g = Fore.GREEN
r = Fore.RED
y = Fore.YELLOW
colors = [w, c, y, g, r]

def a():
    print(f"""
{choice(colors)}       

JJJY55YJJJYY55YYJJJJJJJJJJJJJJJJJJJJY55YJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
YYYYY55YY5YYYYJJJJJJJJJJJJJJJJJJJJJJY55YYJJYYYYYYYYYYYJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
Y5YYJYYYYYJJJJJJJJJJJJJJJJJJJJJJJJYY5YYJ???7777?77777???JJYYYJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
YYYYYY5555YYYJJJJJJJJJJJJJJJJJYJ?77!!!~~~~^~~~~~~~~~~~~~~!!!7?JJYJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJY5YYYYYY5555YYYJJJJJJJJYYJ?!~~~~~~~~~~~!~~~~~~~~~~!~~~~~~~~~~7?JYJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJYYYYYJJJJYY555555555Y55J7~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~?YJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJJJYYYYYYJJJJJYYYY555557~~~~~~~~~~~~~~~~~~~!!7777777777!!~~~~~~~~~~JYJJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
YJJJJJJJYY55YYJJJJJJJJY5!~~~~~~~~~~~~~~~~~~~~~~~~~~~~!!!!!!!~~~~~~~~~~?YJJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJJJJJJJJYY55YYJJYJYJ57~~~~~~~~~~~~~~~~!!!!7777777777777777777!!~~~~~~YYJJJJJJJJJJJJJJJJJJJJJJJJJJJ
JJJJJJJJJJJY55YYJJJJJJ5~~~~~~~~~~~~~~~~~!!~~~~~!!!!!!7!!!!!!~~~~!~~~~~~75JJJJJJJJJJJJJJJJJJJJJJJJJJJ
YYYYYYYYYYYY555YYYYYYY5~~~~~~~~~~~~~~~~~~~~~~7JJJJ?7~~~!7777!~~~~~~~~~^?5YYYYYYYYYYYYYYYYYYYYJYYYYJY
YYYYYYYYYY55PP5YYYYYYY5?~~~~~~~~~~~~~~~~~~~7J??????J?!?J?????7~~~~~~~^!5YYYYYYYYYYYYYYYYYYYYYYYYYYYY
YYYYYYYYYY5PP55YYYYYYYY57~~~~~~~~~~~~~~~~~JJ???????7?PJ?7????J?~~~~~~75YYYYYYYYYYYYYYYYYYYYYYYYYYYYY
55YYYJJYYYY55YYYYYYYYYYY5J!~~~~~~~~~~~~~^7Y7????777?7JJ7?????7Y7~~!?Y5YYYYYYYYYYYYYYYYYYYYYYYYYYYYYY
PP555JPPPPJJJJYYJJYYYYYYY55J7!~~~~~~~~~~~Y??????JYJ??J5????????5JY55YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY
PP55P5Y55JJJJ5555J?5YYYYYYY555YJ?7!!~~~~J57!~^:^GB?:^?5!?GG7!7JP5YYYYYYYYYYYYYYYYYYYYYYYY55YYYYYYYY5
JYYYJJYJJ?J?JJJJJJY5Y5YYYYYYYYY55555Y55~~J^....:PG~..J7~7B5:..7P5YYYYY5555YYYYYY55YYYYY55YYYYYYYYYYY
?YYYYJJY?JYJJJ?JJ5YYYYYYYYYYYYYYYYYYYYP7^!?:....::..77~~!?7^.^5YYYYYYYYYYYYYYYYYYYY5YYYYYYYYYYYYYYYY
YJJYJJ?YY?JJ5YYYJ?YYYYYYYYYYYYYY55Y5555!~~!7~::..:^??~~~~~~7J5YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY
YYYY?YYYYJJJJJJJ?JYYYYYYYYYYYYY5?!~!7?Y~~~~~!!!!!!7!J~~~~~~~!55YJJYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY
YYYYJJJJJJYYYJJYYYYYYYYYYYYYYYY5~~7?!^~~~~~~~~~~~~~~Y~~~~~~~~!Y~!~!5YY5YYYYYYYYYYYYYYYYYYYYYYYYYYYYY
YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY5J!!!77!!~~~~~~~~~~~~Y~~~~~~~~^JJ?!!5YYY555YYYYYYYYY5YYYYYYYYYYYYYYYY
YYYYYYYYYYYYYYYYYYYYYYYYYYYYYYYY5Y?!~~~!77777!!!!!!7J~~~~~~~~~!J~?55YYYY5555555555555Y5555555555YYYY
5555555555555555555555555555555555555Y?7!~~~~~!!!!!??~~~~~~~~~~P555555555555555555555Y5555555555YYYY
555555555555555555555555555555555555555555YJJ77!777J7~~~~~~~~~7P555555555555555555555555555555555555
55555555555555555555555555555555555555555555P!~~YP5P7~~~~~~~~~55555555555555555555555555555555555555
55555555555555555555555555555555555555555555P7~~5555Y!~~~~~~!YP5555555555555555555555555555555555555
55555555555555555555555555555555555555555555P7^!P55555YYJJJY5555555555555555555555555555555555555555
55555555555555555555555555555555555555555555P7^?P555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555P7^JP555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555PG!^YP555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555P55?~Y55P5555555555555555555555555555555555555555555555555
PPP5P555555555555555555555555555555555555PPPJYYP5PGP5555555555PP555555555555555555555PPPP55555P55555
PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP5PPY55555PYPGPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP55PPPPPPP
PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPG5YJYYYYYJ55GPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPGYYYY5YYYY555GPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPG5YYY5PYYYYYPJPGPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPJYYY5PYYYYYPY5GPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP
PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPYYYP5YYYYY55PPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPPP

                    Coded By : Ahmed Hesham                         
""")

def otx_crawls(target):
    headers_list = [
        {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36 Edge/16.16299"},
        {"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36"}
    ]
    f_u = open("urls.txt", 'w')
    f_h = open("hostnames.txt", 'r+')
    page = 1
    while True:
        response = loads(requests.get(f"https://otx.alienvault.com/api/v1/indicators/domain/{target}/url_list?limit=500&page={page}", headers=choice(headers_list)).text)
        if not response["paged"] or not response["has_next"]:
            break
        req = response["url_list"]
        for i in req:
            if not i.get("httpcode") in range(499, 599):
                hostname = str(i.get("hostname"))
                if hostname not in f_h.read():
                    f_h.write(hostname + '\n')
                    f_u.write(i.get("url") + '\n')
        page += 1
    f_u.close()
    f_h.close()

a()
target = input("Enter the target domain: ")
otx_crawls(target)
print(f"{y}[*] Total URLs: {len(open('urls.txt', 'r').readlines())}")
unique_hostnames = set(open('hostnames.txt', 'r').readlines())
print(f"{y}[*] Total unique hostnames: {len(unique_hostnames)}")
with open('unique_hostnames.txt', 'w') as f:
    for hostname in unique_hostnames:
        f.write(hostname)
print(f"{y}[*] Unique hostnames saved to file 'unique_hostnames.txt'.")
